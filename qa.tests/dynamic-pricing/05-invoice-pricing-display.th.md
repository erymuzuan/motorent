# การทดสอบ QA: การแสดงราคาแบบไดนามิกในใบแจ้งหนี้

## รหัสทดสอบ: DP-005
## ฟีเจอร์: รายละเอียดราคาในใบแจ้งหนี้
## ความสำคัญ: สูง

---

## เงื่อนไขเบื้องต้น
- เปิดใช้งานราคาแบบไดนามิกแล้ว (DP-001 ผ่าน)
- มีการเช่าที่สร้างด้วยราคาแบบไดนามิก (DP-004 ผ่าน)
- เปิดใช้งานการตั้งค่า "แสดงตัวคูณในใบแจ้งหนี้"
- ผู้ใช้เข้าสู่ระบบพร้อมสิทธิ์เข้าถึงการเช่า

## ขั้นตอนการทดสอบ

### ขั้นตอนที่ 1: เปิดการเช่าที่มีราคาแบบไดนามิก
1. ไปที่รายการ **การเช่า**
2. หาการเช่าที่ครอบคลุมวันที่ที่มีกฎราคา
3. คลิกเพื่อเปิดรายละเอียดการเช่า

**ผลที่คาดหวัง:** หน้ารายละเอียดการเช่าโหลด

### ขั้นตอนที่ 2: เปิดใบแจ้งหนี้
1. คลิก **ใบแจ้งหนี้** หรือปุ่ม **ดูใบแจ้งหนี้**

**ผลที่คาดหวัง:** ไดอะล็อกใบแจ้งหนี้เปิดแสดงรายละเอียดการเช่า

### ขั้นตอนที่ 3: ตรวจสอบข้อมูลใบแจ้งหนี้พื้นฐาน
1. ตรวจสอบส่วนหัว

**ผลที่คาดหวัง:**
- รหัส/หมายเลขการเช่าแสดง
- ชื่อและข้อมูลติดต่อผู้เช่า
- รายละเอียดยานพาหนะ (ยี่ห้อ, รุ่น, ป้ายทะเบียน)
- วันที่เช่า (เริ่มต้นและสิ้นสุด)

### ขั้นตอนที่ 4: ตรวจสอบส่วนราคาแบบไดนามิก
1. เลื่อนไปที่ส่วนรายละเอียดราคา

**ผลที่คาดหวัง:** ส่วนที่มีชื่อ "รายละเอียดราคา" หรือ "ราคารายวัน" แสดง:
- ตารางพร้อมคอลัมน์ วันที่, อัตรา, ตัวคูณ, จำนวนเงิน
- แต่ละวันเช่าแสดงพร้อมตัวคูณที่ใช้
- วันที่ตัวคูณเดียวกันต่อเนื่องจัดกลุ่ม
- ชื่อกฎที่ใช้แสดง (ถ้าเปิดใช้งานการตั้งค่า)

### ขั้นตอนที่ 5: ตรวจสอบการแสดงตัวคูณ
1. ตรวจสอบค่าในคอลัมน์ตัวคูณ

**ผลที่คาดหวัง:**
- ตัวคูณแสดงเป็น "1.6x", "2.0x", ฯลฯ
- ตัวคูณต่างกันสำหรับช่วงวันที่ต่างกัน
- อัตราพื้นฐาน (1.0x) แสดงสำหรับวันที่ไม่มีกฎ

### ขั้นตอนที่ 6: ตรวจสอบยอดรวม
1. ตรวจสอบส่วนยอดรวม

**ผลที่คาดหวัง:**
- ยอดรวมย่อย (รวมวันเช่า)
- ค่าใช้จ่ายเพิ่มเติม (อุปกรณ์เสริม, ประกัน)
- เงินมัดจำที่ใช้
- ยอดรวมทั้งหมด

### ขั้นตอนที่ 7: ทดสอบโดยซ่อนตัวคูณ
1. ไปที่การตั้งค่าองค์กร
2. ปิดใช้งาน "แสดงตัวคูณในใบแจ้งหนี้"
3. กลับมาที่ใบแจ้งหนี้

**ผลที่คาดหวัง:**
- จำนวนเงินรายวันยังคงแสดง
- คอลัมน์/ค่าตัวคูณซ่อน
- ยอดรวมยังคงเท่าเดิม

---

## ข้อมูลทดสอบ

### ตัวอย่างรายละเอียดใบแจ้งหนี้
| วันที่ | ราคาพื้นฐาน | ตัวคูณ | จำนวนเงิน |
|------|-----------|------------|--------|
| 25 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 26 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 27 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 28 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 29 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 30 ธ.ค. | ฿500 | 2.2x | ฿1,100 |
| 31 ธ.ค. | ฿500 | 2.5x | ฿1,250 |
| 1 ม.ค. | ฿500 | 2.8x | ฿1,400 |
| 2 ม.ค. | ฿500 | 2.8x | ฿1,400 |
| **ยอดรวมย่อย** | | | **฿10,650** |

### การแสดงกฎที่ใช้
- "Ultra Peak Season" (20 ธ.ค. - 10 ม.ค.): 2.2x
- "Russian New Year" (1 ม.ค. - 14 ม.ค.): 2.8x (ความสำคัญสูงกว่า)

## เกณฑ์ผ่าน
- [ ] ใบแจ้งหนี้เปิดสำเร็จสำหรับการเช่าที่มีราคาแบบไดนามิก
- [ ] ส่วนรายละเอียดราคารายวันแสดงให้เห็น
- [ ] แต่ละวันแสดงตัวคูณถูกต้อง
- [ ] จำนวนเงินรายวันคำนวณถูกต้อง
- [ ] ชื่อกฎที่ใช้แสดง (เมื่อเปิดใช้งาน)
- [ ] ยอดรวมถูกต้อง
- [ ] การตั้งค่า "แสดงตัวคูณในใบแจ้งหนี้" ทำงานถูกต้อง
- [ ] สามารถพิมพ์/ส่งออกใบแจ้งหนี้พร้อมรายละเอียดราคาได้

## หมายเหตุ
- ใบแจ้งหนี้ควรพิมพ์ได้พร้อมรายละเอียดราคาครบถ้วน
- การส่งออก PDF ควรรวมรายละเอียดราคาทั้งหมด
- ใบแจ้งหนี้ทางอีเมลควรรวมรายละเอียดเดียวกัน
- การแสดงตัวคูณเป็นทางเลือกตามการตั้งค่าองค์กร
