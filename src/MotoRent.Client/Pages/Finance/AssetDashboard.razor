@page "/finance/asset-dashboard"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Policy = "RequireTenantManager")]
@inherits LocalizedComponentBase<AssetDashboard>
@inject AssetService AssetService
@inject AssetExpenseService ExpenseService
@inject AssetLoanService LoanService

<MotoRentPageTitle>@this.Localizer["AssetDashboard"]</MotoRentPageTitle>

<!-- Page Header with Gradient Icon -->
<div class="mr-page-header">
    <div class="container-xl">
        <nav class="mr-breadcrumb">
            <span class="mr-breadcrumb-item"><a href="/">@this.CommonLocalizer["Home"]</a></span>
            <i class="ti ti-chevron-right mr-breadcrumb-separator"></i>
            <span class="mr-breadcrumb-item"><a href="/finance">@this.Localizer["Finance"]</a></span>
            <i class="ti ti-chevron-right mr-breadcrumb-separator"></i>
            <span class="mr-breadcrumb-item active">@this.Localizer["AssetDashboard"]</span>
        </nav>
        <div class="d-flex justify-content-between align-items-center pb-3">
            <div class="d-flex align-items-center gap-3">
                <div class="mr-header-icon mr-header-icon-finance">
                    <i class="ti ti-chart-pie"></i>
                </div>
                <div>
                    <h1 class="mr-page-title">@this.Localizer["AssetFinancialOverview"]</h1>
                    <p class="mr-page-subtitle mb-0">@this.Localizer["AssetOverviewDescription"]</p>
                </div>
            </div>
            <div class="btn-list">
                <a href="/finance/assets/new" class="btn btn-primary">
                    <i class="ti ti-plus me-1"></i>
                    @this.Localizer["AddAsset"]
                </a>
            </div>
        </div>
    </div>
</div>

<div class="container-xl py-4">
    @if (m_loading)
    {
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">@this.CommonLocalizer["Loading"]</span>
            </div>
        </div>
    }
    else
    {
        <!-- KPI Summary Cards -->
        <div class="mr-finance-kpi-grid mr-animate-in">
            <!-- Total Invested -->
            <div class="mr-kpi-card mr-kpi-invested">
                <div class="mr-kpi-icon">
                    <i class="ti ti-building-bank"></i>
                </div>
                <div class="mr-kpi-content">
                    <span class="mr-kpi-label">@this.Localizer["TotalInvested"]</span>
                    <span class="mr-kpi-value">@m_summary.TotalAcquisitionCost.ToString("N0")</span>
                    <span class="mr-kpi-subtext">
                        <i class="ti ti-motorbike"></i> @this.Localizer["ActiveVehiclesCount", m_summary.ActiveAssets]
                    </span>
                </div>
                <div class="mr-kpi-trend neutral">
                    <span class="mr-kpi-trend-icon"><i class="ti ti-wallet"></i></span>
                </div>
            </div>

            <!-- Current Book Value -->
            <div class="mr-kpi-card mr-kpi-bookvalue">
                <div class="mr-kpi-icon">
                    <i class="ti ti-receipt"></i>
                </div>
                <div class="mr-kpi-content">
                    <span class="mr-kpi-label">@this.Localizer["CurrentBookValue"]</span>
                    <span class="mr-kpi-value">@m_summary.TotalCurrentBookValue.ToString("N0")</span>
                    <span class="mr-kpi-subtext">
                        @this.Localizer["PercentOfOriginal", (m_summary.TotalCurrentBookValue / Math.Max(1, m_summary.TotalAcquisitionCost) * 100).ToString("N0")]
                    </span>
                </div>
                <div class="mr-kpi-gauge">
                    <svg viewBox="0 0 36 36" class="mr-gauge-svg">
                        <path class="mr-gauge-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                        <path class="mr-gauge-fill" stroke-dasharray="@m_bookValuePercent, 100"
                              d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
                    </svg>
                </div>
            </div>

            <!-- Accumulated Depreciation -->
            <div class="mr-kpi-card mr-kpi-depreciation">
                <div class="mr-kpi-icon">
                    <i class="ti ti-trending-down"></i>
                </div>
                <div class="mr-kpi-content">
                    <span class="mr-kpi-label">@this.Localizer["AccumulatedDepreciation"]</span>
                    <span class="mr-kpi-value mr-kpi-warning">@m_summary.TotalAccumulatedDepreciation.ToString("N0")</span>
                    <span class="mr-kpi-subtext">
                        @this.Localizer["PercentDepreciated", (m_summary.TotalAccumulatedDepreciation / Math.Max(1, m_summary.TotalAcquisitionCost) * 100).ToString("N0")]
                    </span>
                </div>
                <div class="mr-kpi-progress">
                    <div class="mr-kpi-progress-bar" style="width: @m_depreciationPercent%"></div>
                </div>
            </div>

            <!-- Net Profit/Loss -->
            <div class="mr-kpi-card @(m_summary.NetProfitLoss >= 0 ? "mr-kpi-profit" : "mr-kpi-loss")">
                <div class="mr-kpi-icon">
                    <i class="ti ti-@(m_summary.NetProfitLoss >= 0 ? "trending-up" : "trending-down")"></i>
                </div>
                <div class="mr-kpi-content">
                    <span class="mr-kpi-label">@this.Localizer["NetProfitLoss"]</span>
                    <span class="mr-kpi-value @(m_summary.NetProfitLoss >= 0 ? "mr-kpi-success" : "mr-kpi-danger")">
                        @(m_summary.NetProfitLoss >= 0 ? "+" : "")@m_summary.NetProfitLoss.ToString("N0")
                    </span>
                    <span class="mr-kpi-subtext">
                        @this.Localizer["Revenue"]: @m_summary.TotalRevenue.ToString("N0")
                    </span>
                </div>
                <div class="mr-kpi-trend @(m_summary.NetProfitLoss >= 0 ? "up" : "down")">
                    <i class="ti ti-arrow-@(m_summary.NetProfitLoss >= 0 ? "up" : "down")-right"></i>
                </div>
            </div>

            <!-- Fleet ROI -->
            <div class="mr-kpi-card mr-kpi-roi">
                <div class="mr-kpi-icon">
                    <i class="ti ti-percentage"></i>
                </div>
                <div class="mr-kpi-content">
                    <span class="mr-kpi-label">@this.Localizer["FleetROI"]</span>
                    <span class="mr-kpi-value mr-kpi-highlight">@m_fleetROI.ToString("N1")%</span>
                    <span class="mr-kpi-subtext">
                        <i class="ti ti-chart-line"></i> @this.Localizer["ReturnOnInvestment"]
                    </span>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="row row-deck row-cards mt-4">
            <!-- Expense Breakdown Donut -->
            <div class="col-lg-6 mr-animate-in mr-animate-delay-1">
                <div class="mr-chart-card">
                    <div class="mr-chart-header">
                        <div class="mr-chart-title">
                            <i class="ti ti-chart-donut"></i>
                            <h3>@this.Localizer["ExpenseBreakdown"]</h3>
                        </div>
                    </div>
                    <div class="mr-chart-body">
                        <div class="mr-donut-legend">
                            @foreach (var expense in m_expensesByCategory.Take(6))
                            {
                                <div class="mr-donut-legend-item">
                                    <span class="mr-donut-color" style="background: @GetCategoryColor(expense.Key)"></span>
                                    <span class="mr-donut-label">@expense.Key.ToString()</span>
                                    <span class="mr-donut-value">@expense.Value.ToString("N0")</span>
                                    <span class="mr-donut-percent">@((expense.Value / Math.Max(1, m_totalExpenses) * 100).ToString("N0"))%</span>
                                </div>
                            }
                        </div>
                    </div>
                    <div class="mr-chart-footer">
                        <span class="mr-expense-total">@this.Localizer["TotalExpensesLabel", m_totalExpenses.ToString("N0")]</span>
                    </div>
                </div>
            </div>

            <!-- Attention Needed / Alerts -->
            <div class="col-lg-6 mr-animate-in mr-animate-delay-1">
                <div class="mr-performance-card mr-attention-needed">
                    <div class="mr-performance-header">
                        <div class="mr-performance-icon warning">
                            <i class="ti ti-alert-triangle"></i>
                        </div>
                        <h3>@this.Localizer["AttentionNeeded"]</h3>
                        @if (m_totalAlerts > 0)
                        {
                            <span class="mr-alert-badge">@m_totalAlerts</span>
                        }
                    </div>
                    <div class="mr-performance-body">
                        <div class="mr-alert-list">
                            @if (m_assetsNeedingDepreciation > 0)
                            {
                                <a href="/finance/depreciation" class="mr-alert-item depreciation">
                                    <div class="mr-alert-icon">
                                        <i class="ti ti-calculator"></i>
                                    </div>
                                    <div class="mr-alert-content">
                                        <span class="mr-alert-title">@this.Localizer["DepreciationDue"]</span>
                                        <span class="mr-alert-desc">
                                            @this.Localizer["AssetsNeedingDepreciationCount", m_assetsNeedingDepreciation]
                                        </span>
                                    </div>
                                    <div class="mr-alert-action">
                                        <i class="ti ti-chevron-right"></i>
                                    </div>
                                </a>
                            }

                            @if (m_overduePayments > 0)
                            {
                                <a href="/finance/loans?filter=overdue" class="mr-alert-item payment">
                                    <div class="mr-alert-icon">
                                        <i class="ti ti-credit-card-off"></i>
                                    </div>
                                    <div class="mr-alert-content">
                                        <span class="mr-alert-title">@this.Localizer["OverduePayments"]</span>
                                        <span class="mr-alert-desc">
                                            @this.Localizer["OverduePaymentsCount", m_overduePayments]
                                        </span>
                                    </div>
                                    <div class="mr-alert-action">
                                        <i class="ti ti-chevron-right"></i>
                                    </div>
                                </a>
                            }

                            @if (m_upcomingPayments > 0)
                            {
                                <a href="/finance/loans?filter=upcoming" class="mr-alert-item upcoming">
                                    <div class="mr-alert-icon">
                                        <i class="ti ti-calendar-due"></i>
                                    </div>
                                    <div class="mr-alert-content">
                                        <span class="mr-alert-title">@this.Localizer["UpcomingPayments"]</span>
                                        <span class="mr-alert-desc">
                                            @this.Localizer["UpcomingPaymentsCount", m_upcomingPayments]
                                        </span>
                                    </div>
                                    <div class="mr-alert-action">
                                        <i class="ti ti-chevron-right"></i>
                                    </div>
                                </a>
                            }

                            @if (m_underperformingAssets > 0)
                            {
                                <a href="/finance/reports/profitability?filter=negative" class="mr-alert-item underperform">
                                    <div class="mr-alert-icon">
                                        <i class="ti ti-trending-down"></i>
                                    </div>
                                    <div class="mr-alert-content">
                                        <span class="mr-alert-title">@this.Localizer["Underperforming"]</span>
                                        <span class="mr-alert-desc">
                                            @this.Localizer["UnderperformingAssetsCount", m_underperformingAssets]
                                        </span>
                                    </div>
                                    <div class="mr-alert-action">
                                        <i class="ti ti-chevron-right"></i>
                                    </div>
                                </a>
                            }

                            @if (m_totalAlerts == 0)
                            {
                                <div class="mr-all-clear">
                                    <i class="ti ti-circle-check"></i>
                                    <span>@this.Localizer["AllClear"]</span>
                                    <p>@this.Localizer["NoImmediateActions"]</p>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Tables -->
        <div class="row row-deck row-cards mt-4">
            <!-- Top Performers -->
            <div class="col-lg-6 mr-animate-in mr-animate-delay-2">
                <div class="mr-performance-card mr-top-performers">
                    <div class="mr-performance-header">
                        <div class="mr-performance-icon success">
                            <i class="ti ti-trophy"></i>
                        </div>
                        <h3>@this.Localizer["TopPerformers"]</h3>
                        <span class="mr-performance-badge">@this.Localizer["HighestROI"]</span>
                    </div>
                    <div class="mr-performance-body">
                        @if (m_topPerformers.Any())
                        {
                            <div class="mr-performer-list">
                                @{ var rank = 1; }
                                @foreach (var asset in m_topPerformers)
                                {
                                    <a href="/finance/assets/@asset.AssetId" class="mr-performer-item">
                                        <div class="mr-performer-rank @GetRankClass(rank)">@rank</div>
                                        <div class="mr-performer-info">
                                            <span class="mr-performer-name">@asset.VehicleName</span>
                                            <span class="mr-performer-plate">@asset.LicensePlate</span>
                                        </div>
                                        <div class="mr-performer-stats">
                                            <span class="mr-performer-roi success">
                                                <i class="ti ti-trending-up"></i>
                                                @asset.ROIPercent.ToString("N1")%
                                            </span>
                                            <span class="mr-performer-revenue">
                                                @this.Localizer["RevenueLabel", asset.TotalRevenue.ToString("N0")]
                                            </span>
                                        </div>
                                    </a>
                                    rank++;
                                }
                            </div>
                        }
                        else
                        {
                            <div class="mr-empty-state">
                                <i class="ti ti-chart-bar-off"></i>
                                <span>@this.Localizer["NoPerformanceData"]</span>
                            </div>
                        }
                    </div>
                    <div class="mr-performance-footer">
                        <a href="/finance/reports/profitability" class="btn btn-ghost-primary btn-sm">
                            @this.Localizer["ViewAllPerformance"] <i class="ti ti-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Worst Performers -->
            <div class="col-lg-6 mr-animate-in mr-animate-delay-2">
                <div class="mr-performance-card">
                    <div class="mr-performance-header">
                        <div class="mr-performance-icon" style="background: rgba(239, 68, 68, 0.1); color: #ef4444;">
                            <i class="ti ti-trending-down-2"></i>
                        </div>
                        <h3>@this.Localizer["UnderperformingAssets"]</h3>
                    </div>
                    <div class="mr-performance-body">
                        @if (m_worstPerformers.Any())
                        {
                            <div class="mr-performer-list">
                                @foreach (var asset in m_worstPerformers)
                                {
                                    <a href="/finance/assets/@asset.AssetId" class="mr-performer-item">
                                        <div class="mr-performer-info">
                                            <span class="mr-performer-name">@asset.VehicleName</span>
                                            <span class="mr-performer-plate">@asset.LicensePlate</span>
                                        </div>
                                        <div class="mr-performer-stats">
                                            <span class="mr-performer-roi" style="color: #ef4444;">
                                                <i class="ti ti-trending-down"></i>
                                                @asset.ROIPercent.ToString("N1")%
                                            </span>
                                            <span class="mr-performer-revenue">
                                                @this.Localizer["LossLabel", Math.Abs(asset.NetProfitLoss).ToString("N0")]
                                            </span>
                                        </div>
                                    </a>
                                }
                            </div>
                        }
                        else
                        {
                            <div class="mr-all-clear">
                                <i class="ti ti-circle-check"></i>
                                <span>@this.Localizer["AllAssetsProfitable"]</span>
                                <p>@this.Localizer["NoUnderperformingAssets"]</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Asset List with Filtering -->
        <div class="card mt-4 mr-animate-in mr-animate-delay-3">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="ti ti-list me-2"></i>
                    @this.Localizer["AllAssets"]
                </h3>
                <div class="card-actions">
                    <div class="btn-group me-2">
                        <button class="btn btn-sm @(m_statusFilter == null ? "btn-primary" : "btn-outline-secondary")"
                                @onclick="() => FilterByStatus(null)">
                            @this.Localizer["AllCount", m_summary.TotalAssets]
                        </button>
                        <button class="btn btn-sm @(m_statusFilter == AssetStatus.Active ? "btn-primary" : "btn-outline-secondary")"
                                @onclick="() => FilterByStatus(AssetStatus.Active)">
                            <i class="ti ti-circle-check me-1"></i>@this.Localizer["ActiveCount", m_summary.ActiveAssets]
                        </button>
                        <button class="btn btn-sm @(m_statusFilter == AssetStatus.Disposed ? "btn-primary" : "btn-outline-secondary")"
                                @onclick="() => FilterByStatus(AssetStatus.Disposed)">
                            <i class="ti ti-cash me-1"></i>@this.Localizer["DisposedCount", m_summary.DisposedAssets]
                        </button>
                        <button class="btn btn-sm @(m_statusFilter == AssetStatus.WriteOff ? "btn-primary" : "btn-outline-secondary")"
                                @onclick="() => FilterByStatus(AssetStatus.WriteOff)">
                            <i class="ti ti-trash me-1"></i>@this.Localizer["WrittenOffCount", m_summary.WrittenOffAssets]
                        </button>
                    </div>
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-vcenter card-table table-hover">
                    <thead>
                        <tr>
                            <th>@this.Localizer["Vehicle"]</th>
                            <th>@this.Localizer["Status"]</th>
                            <th class="text-end">@this.Localizer["AcquisitionCost"]</th>
                            <th class="text-end">@this.Localizer["BookValue"]</th>
                            <th class="text-end">@this.Localizer["Depreciation"]</th>
                            <th class="text-end">@this.Localizer["ROI"]</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var asset in m_filteredAssets)
                        {
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar bg-primary-lt me-2">
                                            <i class="ti ti-motorbike"></i>
                                        </div>
                                        <div>
                                            <div class="fw-bold">@asset.VehicleName</div>
                                            <small class="text-muted">@asset.LicensePlate</small>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="badge @GetStatusBadgeClass(asset.Status)">@asset.Status</span>
                                </td>
                                <td class="text-end">@asset.AcquisitionCost.ToString("N0")</td>
                                <td class="text-end">
                                    <span class="@(asset.Status == AssetStatus.WriteOff ? "text-danger" : "")">
                                        @asset.CurrentBookValue.ToString("N0")
                                    </span>
                                </td>
                                <td class="text-end text-warning">@asset.AccumulatedDepreciation.ToString("N0")</td>
                                <td class="text-end">
                                    <span class="@(asset.ROIPercent >= 0 ? "text-success" : "text-danger")">
                                        @(asset.ROIPercent >= 0 ? "+" : "")@asset.ROIPercent.ToString("N1")%
                                    </span>
                                </td>
                                <td>
                                    <div class="btn-group">
                                        <a href="/finance/assets/@asset.AssetId/details" class="btn btn-sm btn-outline-primary" title="@this.Localizer["ViewDetails"]">
                                            <i class="ti ti-chart-line"></i>
                                        </a>
                                        <a href="/finance/assets/@asset.AssetId" class="btn btn-sm btn-outline-secondary" title="@this.Localizer["Edit"]">
                                            <i class="ti ti-edit"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                        @if (!m_filteredAssets.Any())
                        {
                            <tr>
                                <td colspan="7" class="text-center text-muted py-4">
                                    <i class="ti ti-database-off" style="font-size: 2rem;"></i>
                                    <p class="mb-0 mt-2">@this.Localizer["NoAssetsFound"]</p>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="mr-quick-actions mr-animate-in mr-animate-delay-3 mt-4">
            <div class="mr-quick-actions-header">
                <i class="ti ti-bolt"></i>
                <h3>@this.Localizer["QuickActions"]</h3>
            </div>
            <div class="mr-quick-actions-body">
                <a href="/finance/depreciation/run" class="btn btn-primary">
                    <i class="ti ti-calculator me-1"></i>
                    @this.Localizer["RunMonthlyDepreciation"]
                </a>
                <a href="/finance/expenses/new" class="btn btn-success">
                    <i class="ti ti-receipt-2 me-1"></i>
                    @this.Localizer["RecordExpense"]
                </a>
                <a href="/finance/depreciation-report" class="btn btn-outline-secondary">
                    <i class="ti ti-report me-1"></i>
                    @this.Localizer["DepreciationReport"]
                </a>
                <a href="/finance/loans" class="btn btn-outline-info">
                    <i class="ti ti-credit-card me-1"></i>
                    @this.Localizer["ManageLoans"]
                </a>
            </div>
        </div>
    }
</div>

@code {
    private bool m_loading = true;
    private AssetSummary m_summary = new();
    private List<Asset> m_topPerformers = [];
    private List<Asset> m_worstPerformers = [];
    private List<Asset> m_allAssets = [];
    private List<Asset> m_filteredAssets = [];
    private AssetStatus? m_statusFilter = null;
    private Dictionary<AssetExpenseCategory, decimal> m_expensesByCategory = new();

    private decimal m_totalExpenses;
    private decimal m_fleetROI;
    private decimal m_bookValuePercent;
    private decimal m_depreciationPercent;

    private int m_assetsNeedingDepreciation;
    private int m_overduePayments;
    private int m_upcomingPayments;
    private int m_underperformingAssets;
    private int m_totalAlerts => m_assetsNeedingDepreciation + m_overduePayments + m_upcomingPayments + m_underperformingAssets;

    protected override async Task OnInitializedAsync()
    {
        await LoadDashboardDataAsync();
    }

    private async Task LoadDashboardDataAsync()
    {
        try
        {
            m_loading = true;

            // Load summary
            m_summary = await AssetService.GetSummaryAsync();

            // Calculate percentages
            m_bookValuePercent = m_summary.TotalAcquisitionCost > 0
                ? (m_summary.TotalCurrentBookValue / m_summary.TotalAcquisitionCost * 100)
                : 0;
            m_depreciationPercent = m_summary.TotalAcquisitionCost > 0
                ? (m_summary.TotalAccumulatedDepreciation / m_summary.TotalAcquisitionCost * 100)
                : 0;
            m_fleetROI = m_summary.TotalAcquisitionCost > 0
                ? (m_summary.NetProfitLoss / m_summary.TotalAcquisitionCost * 100)
                : 0;

            // Load all assets
            var allAssetsResult = await AssetService.GetAssetsAsync(null, 1, 1000);
            m_allAssets = allAssetsResult.ItemCollection.ToList();
            ApplyFilter();

            // Load performers (from active assets only)
            var activeAssets = m_allAssets.Where(a => a.Status == AssetStatus.Active).ToList();
            m_topPerformers = activeAssets
                .OrderByDescending(a => a.ROIPercent)
                .Take(5)
                .ToList();
            m_worstPerformers = activeAssets
                .Where(a => a.ROIPercent < 0)
                .OrderBy(a => a.ROIPercent)
                .Take(5)
                .ToList();

            // Load expense breakdown
            m_expensesByCategory = await ExpenseService.GetExpensesByCategoryAsync();
            m_totalExpenses = m_expensesByCategory.Values.Sum();

            // Load alerts
            await LoadAlertsAsync();
        }
        finally
        {
            m_loading = false;
        }
    }

    private async Task LoadAlertsAsync()
    {
        m_assetsNeedingDepreciation = await AssetService.GetAssetsNeedingDepreciationCountAsync();
        m_overduePayments = await LoanService.GetOverduePaymentsCountAsync();
        m_upcomingPayments = await LoanService.GetUpcomingPaymentsCountAsync(7);
        m_underperformingAssets = await AssetService.GetUnderperformingAssetsCountAsync();
    }

    private string GetCategoryColor(AssetExpenseCategory category) => category switch
    {
        AssetExpenseCategory.Maintenance => "#22c55e",
        AssetExpenseCategory.Financing => "#3b82f6",
        AssetExpenseCategory.Insurance => "#8b5cf6",
        AssetExpenseCategory.Accident => "#ef4444",
        AssetExpenseCategory.Registration => "#f59e0b",
        AssetExpenseCategory.Consumables => "#06b6d4",
        AssetExpenseCategory.Fuel => "#84cc16",
        AssetExpenseCategory.Cleaning => "#14b8a6",
        AssetExpenseCategory.Inspection => "#f97316",
        AssetExpenseCategory.Tax => "#6366f1",
        _ => "#6b7280"
    };

    private string GetRankClass(int rank) => rank switch
    {
        1 => "gold",
        2 => "silver",
        3 => "bronze",
        _ => ""
    };

    private void FilterByStatus(AssetStatus? status)
    {
        m_statusFilter = status;
        ApplyFilter();
    }

    private void ApplyFilter()
    {
        m_filteredAssets = m_statusFilter.HasValue
            ? m_allAssets.Where(a => a.Status == m_statusFilter.Value).ToList()
            : m_allAssets;
    }

    private string GetStatusBadgeClass(AssetStatus status) => status switch
    {
        AssetStatus.Active => "bg-success-lt",
        AssetStatus.Disposed => "bg-warning-lt",
        AssetStatus.WriteOff => "bg-danger-lt",
        _ => "bg-secondary-lt"
    };
}
