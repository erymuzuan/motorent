@page "/"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Policy = "RequireTenantStaff")]
@inherits LocalizedComponentBase<Home>

<MotoRentPageTitle>Dashboard</MotoRentPageTitle>

<TablerHeader Title="Dashboard" PreTitle="Overview" />

<div class="row row-deck row-cards mb-4">
    <div class="col-sm-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="subheader">Active Rentals</div>
                    <div class="ms-auto lh-1">
                        <span class="text-primary">
                            <i class="ti ti-receipt fs-2"></i>
                        </span>
                    </div>
                </div>
                <div class="h1 mb-3">12</div>
                <div class="d-flex mb-2">
                    <div>
                        <span class="text-success d-inline-flex align-items-center lh-1">
                            <i class="ti ti-trending-up me-1"></i> 8%
                        </span>
                        <span class="text-secondary">vs last week</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="subheader">Available Bikes</div>
                    <div class="ms-auto lh-1">
                        <span class="text-success">
                            <i class="ti ti-motorbike fs-2"></i>
                        </span>
                    </div>
                </div>
                <div class="h1 mb-3">24</div>
                <div class="d-flex mb-2">
                    <div>
                        <span class="text-secondary">out of 36 total</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="subheader">Due Today</div>
                    <div class="ms-auto lh-1">
                        <span class="text-warning">
                            <i class="ti ti-clock fs-2"></i>
                        </span>
                    </div>
                </div>
                <div class="h1 mb-3">5</div>
                <div class="d-flex mb-2">
                    <div>
                        <span class="text-secondary">returns scheduled</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-sm-6 col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="subheader">Today's Revenue</div>
                    <div class="ms-auto lh-1">
                        <span class="text-secondary">
                            <i class="ti ti-currency-baht fs-2"></i>
                        </span>
                    </div>
                </div>
                <div class="h1 mb-3">8,500</div>
                <div class="d-flex mb-2">
                    <div>
                        <span class="text-success d-inline-flex align-items-center lh-1">
                            <i class="ti ti-trending-up me-1"></i> 12%
                        </span>
                        <span class="text-secondary">vs yesterday</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row row-deck row-cards">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Recent Rentals</h3>
            </div>
            <div class="table-responsive">
                <table class="table table-vcenter card-table table-striped">
                    <thead>
                        <tr>
                            <th>Renter</th>
                            <th>Motorbike</th>
                            <th>Start Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var rental in m_recentRentals)
                        {
                            <tr>
                                <td>@rental.RenterName</td>
                                <td>@rental.MotorbikeName</td>
                                <td>@rental.StartDate.ToString("dd MMM yyyy")</td>
                                <td>
                                    <span class="badge @(rental.Status == "Active" ? "bg-success" : "bg-secondary")">
                                        @rental.Status
                                    </span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Quick Actions</h3>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="/rentals/checkin" class="btn btn-primary">
                        <i class="ti ti-login me-2"></i>
                        New Check-In
                    </a>
                    <a href="/rentals/checkout" class="btn btn-outline-primary">
                        <i class="ti ti-logout me-2"></i>
                        Process Check-Out
                    </a>
                    <a href="/renters" class="btn btn-outline-secondary">
                        <i class="ti ti-user-plus me-2"></i>
                        Register Renter
                    </a>
                    <a href="/motorbikes" class="btn btn-ghost-secondary">
                        <i class="ti ti-motorbike me-2"></i>
                        Manage Inventory
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private record RentalSummary(string RenterName, string MotorbikeName, DateTime StartDate, string Status);

    private List<RentalSummary> m_recentRentals =
    [
        new("John Smith", "Honda Click 125", DateTime.Today.AddDays(-2), "Active"),
        new("Maria Garcia", "Yamaha Aerox 155", DateTime.Today.AddDays(-1), "Active"),
        new("James Wilson", "Honda PCX 160", DateTime.Today, "Active"),
        new("Sophie Chen", "Yamaha NMAX 155", DateTime.Today.AddDays(-3), "Active"),
        new("Alex Brown", "Honda Click 125", DateTime.Today.AddDays(-5), "Completed")
    ];
}
